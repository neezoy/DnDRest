<!DOCTYPE html>
<html>
<head>

    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="Master.css">

    <script> function insertTable(){
        $("#myTable tbody tr").remove();
        var userList;
        $.get("http://localhost:8080/rest/user/all", function(data){
            userList = data;
            console.log("insertTable virker i users");
            console.log(userList);
            for ( i in userList) {
                var table = document.getElementById("myTable").getElementsByTagName("tbody")[0];
                var row1 = table.insertRow(0);
                var cell1Id = row1.insertCell(0);
                var cell2Name = row1.insertCell(1);
                var cell3Role = row1.insertCell(2);
                var cell4Status = row1.insertCell(3);

                cell1Id.innerHTML = userList[i].id;
                cell2Name.innerHTML = userList[i].name;
                cell3Role.innerHTML= userList[i].role;
                cell4Status.innerHTML = userList[i].status;


            }
        }).fail(function () {
            console.log("Fejl i insertTable i users");
        });

    }</script>

</head>
<body onload="insertTable();">
<div id = "headerDiv">
    <h2>D&D</h2>
    <div id = "headerContainer">
        <button onclick="switchPage('AllUsers.html');">User</button>
        <button onclick="switchPage('AllCharacters.html');">Character</button>
        <button onclick="switchPage('AllItems.html');">Item</button>
        <button onclick="switchPage('AllGroups.html');">Group</button>
    </div>
</div>

    <br>

    <div class="innerBody">
            <table id="myTable">
                <thead>
                    <th>Id</th>
                    <th>User name</th>
                    <th>Role</th>
                    <th>Status</th>

                </thead>
                <tbody>

                </tbody>
            </table>




    <form action="rest/user/save" method="post">
        <p>User name  <input type="text" name="username" id="username" /></p>
        <p>Role  <input type="text" name="role" id="role" /></p>
        <p>Password  <input type="text" name="password" id="password" /></p>
        <p>Status  <input type="text" name="status" id="status"/></p>
        <input type="submit" value="Create" onclick=selecter(1); />
        <input type="submit" value="Update" onclick=selecter(2); />
        <input type="submit" value="Delete" onclick=selecter(3); />
        <p><input type="hidden" value="" name="userid" id="userid"/></p>
        <p><input type="hidden" value="" name="selection" id="selection"/></p>
    </form>


        <script>insertTable();</script>

    <form onload="updateTextField()" action="rest/user/search">
        <p>Character ID <input type="text" name="id" id="id" /></p>
        <input type="button" onclick=updateTextField();insertList(); value="Search"/>
    </form>

    <form onload="approved()" action="rest/user/approve/" method="post">
        <input type="button" value="Approved" onclick=approved(); />
    </form>

    <script>function approved() {
        $.get("http://localhost:8080/rest/user/approve/" + document.getElementById("id").value + "/1" , function (data) {
        });
    } </script>

    <form onload="disapproved()" action="rest/user/approve/" method="post">
        <input type="button" value="Disapproved" onclick=disapproved(); />
    </form>

    <script>function disapproved() {
        $.get("http://localhost:8080/rest/user/approve/" + document.getElementById("id").value + "/2" , function (data) {
        });
    } </script>

    <script>function updateTextField() {
        $.get("http://localhost:8080/rest/user/"+document.getElementById("id").value, function(data){
            document.getElementById("username").value = data.name;
            document.getElementById("role").value = data.role;
            document.getElementById("password").value = data.password;
            document.getElementById("userid").value = document.getElementById("id").value;
            });
    } </script>

    <script>function selecter(x) {
        document.getElementById("selection").value = x;
    } </script>

        <table id="list">
            <thead>
            <th>User's Characters</th>

            </thead>
            <tbody>

            </tbody>
        </table>


        <script> function insertList(){
            $("#list tbody tr").remove();
            var characterList;
            $.get("http://localhost:8080/rest/relation/usercharacters/"+document.getElementById("id").value, function (data) {
                characterList = data;
                console.log("insertList i users virker");
                console.log(characterList);
                for (i in characterList) {
                    var table = document.getElementById("list").getElementsByTagName("tbody")[0];
                    var row1 = table.insertRow(0);
                    var cell1Name = row1.insertCell(0);

                    cell1Name.innerHTML = characterList[i].name;
                }

            }).fail(function () {
                console.log("Fejl i insertList p√• user");
            });
        }

        insertList();</script>

        <script>function filterPending(){
            var input, filter, table, tbody, i, txtValue;
            input = "Status 0";
            filter = input.value.toUpperCase();
            table = document.getElementById("myTable");
            row1 = table.getElementsByTagName("row1");

            for (i = 0; i < row1.length; i++) {
                tbody = row1[i].getElementsByTagName("tbody")[3];
                if (tbody) {
                    txtValue = tbody.textContent || tbody.innerText;
                    if  (txtValue.toUpperCase().indexOf(filter) >-1) {
                        row1[i].style.display = "";
                    } else {
                        row1[i].style.display = "none";
                    }
                }
            }

        }</script>


    </div>

</body>
</html>