<!DOCTYPE html>
<html>
<head>

    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="Master.css">
    <script type="text/javascript" src="jquery-3.4.1.js"></script>

    <script> function insertTable() {
        $("#myTable tbody tr").remove();
        var characterList;
        $.get("http://localhost:8080/rest/character/all", function (data) {
            characterList = data;
            console.log("insertTable virker i chars");
            for (i in characterList) {
                var table = document.getElementById("myTable").getElementsByTagName("tbody")[0];
                var row1 = table.insertRow(0);
                var cell1Id = row1.insertCell(0);
                var cell2Name = row1.insertCell(1);
                var cell3Location = row1.insertCell(2);

                cell1Id.innerHTML = characterList[i].id;
                cell2Name.innerHTML = characterList[i].name;
                cell3Location.innerHTML = characterList[i].location;
            }
        }).fail(function () {
            console.log("Fejl i insertTable i char");
        });
    }</script>


</head>
<body onload="insertTable();">
<div id="headerDiv">
    <h2>D&D</h2>
    <div id="headerContainer">
        <button onclick="switchPage('AllUsers.html');">User</button>
        <button onclick="switchPage('AllCharacters.html');">Character</button>
        <button onclick="switchPage('AllItems.html');">Item</button>
        <button onclick="switchPage('AllGroups.html');">Group</button>
    </div>
</div>

<br>

<div class="innerBody">
    <table id="myTable">
        <thead>
        <th>Id</th>
        <th>Character name</th>
        <th>Location</th>

        </thead>
        <tbody>

        </tbody>
    </table>

    <script>insertTable();</script>


    <form action="rest/character/save" method="post">
        <p>Character name <input type="text" name="charactername" id="charactername"/></p>
        <p>Location <input type="text" name="location" id="location"/></p>
        <p>Strength <input type="text" name="strength" id="strength"/></p>
        <p>Bonus Capacity <input type="text" name="bonus" id="bonus"/></p>
        <input type="submit" value="Create" onclick=selecter(1); />
        <input type="submit" value="Update" onclick=selecter(2); />
        <input type="submit" value="Delete" onclick=selecter(3); />
        <p><input type="hidden" value="" name="characterid" id="characterid"/></p>
        <p><input type="hidden" value="" name="selection" id="selection"/></p>
    </form>

    <form onload="updateTextField()" action="rest/character/search">
        <p>Character ID <input type="text" name="id" id="id"/></p>
        <input type="button" onclick=updateTextField();insertList();insertList2(); value="Search"/>
    </form>

    <form action="rest/character/approve/{id}/{approval}/{role}" method="post">
        <input type="button" value="Approved" onclick=approved(1); />
    </form>

    <script>function approved(approval) {
        $.post("http://localhost:8080/rest/character/approve/" + document.getElementById("id").value + "/" + approval + "/" + role , function (data) {
        });
    } </script>

    <form action="rest/character/approve/{id}/{approval}/{role}" method="post">
        <input type="button" value="Disapproved" onclick=approved(0); />
    </form>


    <script>function updateTextField() {
        $.get("http://localhost:8080/rest/character/" + document.getElementById("id").value, function (data) {
            document.getElementById("charactername").value = data.name;
            document.getElementById("location").value = data.location;
            document.getElementById("strength").value = data.strength;
            document.getElementById("bonus").value = data.bonus;
            document.getElementById("characterid").value = document.getElementById("id").value;
        });
    } </script>

    <script>function selecter(x) {
        document.getElementById("selection").value = x;
    } </script>

    <button onclick="insertTable()">Update table</button>

    <form>
        <p>Item ID<input type="text" value="" id="itemId" /></p>
        <input type="button" value="Add Item" onclick=addItem(document.getElementById("itemId").value,document.getElementById("id").value); />
        <input type="button" value="Remove Item" onclick=removeItem(document.getElementById("itemId").value,document.getElementById("id").value); />
    </form>

    <script> function addItem(itemId,charId) {
        $.post("http://localhost:8080/rest/character/additem/" + itemId + "/" + charId, function (data) {
        })
    }

    </script>

    <script> function removeItem(itemId,charId) {
        $.post("http://localhost:8080/rest/character/removeitem/" + itemId + "/" + charId, function (data) {
        })
    }
    </script>

    <form>
    <p>Group ID<input type="text" value="" id="groupId" /></p>
    <input type="button" value="Add Group" onclick=addGroup(document.getElementById("groupId").value,document.getElementById("id").value); />
    <input type="button" value="Remove Group" onclick=removeGroup(document.getElementById("groupId").value,document.getElementById("id").value); />
    </form>

    <script> function addGroup(groupId,charId) {
        $.post("http://localhost:8080/rest/character/addgroup/" + groupId + "/" + charId, function (data) {
        })
    }

    </script>

    <script> function removeGroup(groupId,charId) {
        $.post("http://localhost:8080/rest/character/removegroup/" + groupId + "/" + charId, function (data) {
        })
    }
    </script>


    <script> function insertList(){
        $("#list tbody tr").remove();
        var itemList;
        $.get("http://localhost:8080/rest/relation/characteritems/"+document.getElementById("id").value, function (data) {
            itemList = data;
            console.log("insertList i chars virker");
            console.log(itemList);
            for (i in itemList) {
                var table = document.getElementById("list").getElementsByTagName("tbody")[0];
                var row1 = table.insertRow(0);
                var cell1Name = row1.insertCell(0);

                cell1Name.innerHTML = itemList[i].name;
            }

        }).fail(function () {
            console.log("Fejl i insertList på char");
        });
    }

    insertList();</script>

    <table id="list">
        <thead>
        <th>Character's Items</th>

        </thead>
        <tbody>

        </tbody>
    </table>



    <script> function insertList2() {
        $("#list tbody tr").remove();
        var groupList;
        $.get("http://localhost:8080/rest/relation/charactergroups/"+document.getElementById("id").value, function (data) {
            groupList = data;
            console.log("insertList2 i chars virker");
            console.log(groupList);
            for (i in groupList) {
                var table = document.getElementById("list2").getElementsByTagName("tbody")[0];
                var row1 = table.insertRow(0);
                var cell1Name = row1.insertCell(0);

                cell1Name.innerHTML = groupList[i].name;
            }

        }).fail(function () {
            console.log("Fejl i insertList2 på char");
        });
    }

    insertList2();</script>

    <table id="list2">
        <thead>
        <th>Character's Groups</th>

        </thead>
        <tbody>

        </tbody>
    </table>




</div>
</body>
</html>